!function(){var t,l=function(){try{return"undefined"!=typeof XLSX}catch(t){return!1}},a={toString:function(t,n){return null==n&&(n="\t"),t.map(function(t,e){return t.map(function(t,e){return t+""}).join(n)}).join("\r\n"),t.map(function(t,e){return t.map(function(t,e){return'"'+(""+t).replace(/"/g,'""').replace(/\n/g,"\r")+'"'}).join(n)}).join("\r\n")},toArray:function(t,e){for(var n,o=a.toString(t,e=null==e?"\t":e),r=new Uint8Array(2+2*o.length),l=0,u=o.length;l<u;++l)r[2*(n=l)+2]=o.charCodeAt(n),r[2*n+3]=o.charCodeAt(n)>>8;return r[0]=255,r[1]=254,r},toXlsx:function(t){var e;if(l())return e=XLSX.utils.book_new(),t=XLSX.utils.aoa_to_sheet(t),XLSX.utils.book_append_sheet(e,t,"Sheet1"),e;throw new Error("XLSX module not found. Please include xlsx.js in your project.")},toBlob:function(t,e){var n,o,r=(e=null==e?{delimiter:"\t",format:"auto"}:e).delimiter||"\t";if("xlsx"===(e=e.format||"auto")||"auto"===e&&l())try{return n=a.toXlsx(t),o=XLSX.write(n,{type:"array",bookType:"xlsx"}),new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}catch(t){console.warn("Failed to create XLSX. Falling back to CSV/TSV format.",t)}return e=a.toArray(t,r),new Blob([e],{type:","===r?"text/csv":"text/tab-separated-values"})},toHref:function(t,e){t=a.toBlob(t,e=null==e?{delimiter:"\t",format:"auto"}:e);return URL.createObjectURL(t)},download:function(t,e,n){var o,r;return null==e&&(e="data"),o=(n=null==n?{delimiter:"\t",format:"auto"}:n).delimiter||"\t",r="xlsx"===(r=n.format||"auto")||"auto"===r&&l()?(()=>{try{return".xlsx"}catch(t){return","===o?".csv":".tsv"}})():","===o?".csv":".tsv",t=this.toHref(t,n),(n=document.createElement("a")).setAttribute("href",t),n.setAttribute("download",e+(new RegExp("\\"+r+"$","i").exec(e)?"":r)),n.style.opacity=0,n.style.position="absolute",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},e=function(t,e){return a.toHref(t,e=null==e?{delimiter:"\t",format:"auto"}:e)},n=e,o=a,r={}.hasOwnProperty;for(t in o)r.call(o,t)&&(n[t]=o[t]);"undefined"!=typeof module&&null!==module?module.exports=e:"undefined"!=typeof window&&null!==window&&(window.csv4xls=e)}.call(this);
