!function(){var t,s=function(){try{return"undefined"!=typeof XLSX}catch(t){return!1}},m=function(t){return{format:(t=null==t?{}:t).format||"auto",delimiter:t.delimiter||{csv:",",tsv:"t"}[t.format]||"t"}},f={toString:function(t,l){return null==l&&(l="\t"),t.map(function(t,e){return t.map(function(t,e){return t+""}).join(l)}).join("\r\n"),t.map(function(t,e){return t.map(function(t,e){return'"'+(""+t).replace(/"/g,'""').replace(/\n/g,"\r")+'"'}).join(l)}).join("\r\n")},toArray:function(t,e){for(var l,o=f.toString(t,e=null==e?"\t":e),r=new Uint8Array(2+2*o.length),n=0,a=o.length;n<a;++n)r[2*(l=n)+2]=o.charCodeAt(l),r[2*l+3]=o.charCodeAt(l)>>8;return r[0]=255,r[1]=254,r},toXlsx:function(t){var e;if(s())return e=XLSX.utils.book_new(),t=XLSX.utils.aoa_to_sheet(t),XLSX.utils.book_append_sheet(e,t,"Sheet1"),e;throw new Error("XLSX module not found. Please include xlsx.js in your project.")},toBlob:function(t,e){var l,o,r,n,a,i,u,c=(d=m(e=null==e?{delimiter:void 0,format:"auto"}:e)).format,d=d.delimiter;if("xlsx"===c||"auto"===c&&s())try{return l=f.toXlsx(t),o=XLSX.write(l,{type:"array",bookType:"xlsx"}),new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}catch(t){console.warn("Failed to create XLSX. Falling back to CSV/TSV format.",t)}if("html"===c)return r=f.toHtml(t,e.html||{}),new Blob([r],{type:"text/html"});if("xls-html"!==c)return n=f.toArray(t,d),new Blob([n],{type:","===d?"text/csv":"text/tab-separated-values"});for(r=f.toHtml(t,e.html||{}),(n=new Uint8Array(2+2*r.length))[0]=255,n[1]=254,a=0,i=r.length;a<i;++a)n[2*(u=a)+2]=r.charCodeAt(u),n[2*u+3]=r.charCodeAt(u)>>8;return new Blob([n],{type:"application/vnd.ms-excel"})},toHref:function(t,e){t=f.toBlob(t,e=null==e?{delimiter:void 0,format:"auto"}:e);return URL.createObjectURL(t)},download:function(t,e,l){var o,r;return null==e&&(e="data"),o=(r=m(l=null==l?{delimiter:void 0,format:"auto"}:l)).format,r=r.delimiter,o="xlsx"===o||"auto"===o&&s()?".xlsx":"html"===o?".html":"xls-html"===o?".xls":","===r?".csv":".tsv",r=this.toHref(t,l),(t=document.createElement("a")).setAttribute("href",r),t.setAttribute("download",e+(new RegExp("\\"+o+"$","i").exec(e)?"":o)),t.style.opacity=0,t.style.position="absolute",document.body.appendChild(t),t.click(),document.body.removeChild(t)},toHtml:function(t,e){for(var l,o,r,n,a,i,u,c='<table class="'+(l={tableClass:(e=null==e?{}:e).tableClass||"csv4xls-table",cellStyle:e.cellStyle||!0,headerRow:e.headerRow||!1}).tableClass+'">',d=0,s=t.length;d<s;++d){for(r=t[o=d],n=l.headerRow&&0===o?"th":"td",c+="<tr>",a=0,i=r.length;a<i;++a)u=r[a],c+="<"+n+(l.cellStyle?" style=\"mso-number-format:'\\@';\"":"")+">"+(""+u).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")+"</"+n+">";c+="</tr>"}return c+="</table>"}},e=function(t,e){return f.toHref(t,e=null==e?{delimiter:void 0,format:"auto"}:e)},l=e,o=f,r={}.hasOwnProperty;for(t in o)r.call(o,t)&&(l[t]=o[t]);"undefined"!=typeof module&&null!==module?module.exports=e:"undefined"!=typeof window&&null!==window&&(window.csv4xls=e)}.call(this);
