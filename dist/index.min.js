!function(){var t,s=function(){try{return"undefined"!=typeof XLSX}catch(t){return!1}},m=function(t){return{format:(t=null==t?{}:t).format||"auto",delimiter:t.delimiter||{csv:",",tsv:"t"}[t.format]||"t",forceText:t.forceText||!1}},p={toString:function(t,o){return null==o&&(o="\t"),t.map(function(t,e){return t.map(function(t,e){return t+""}).join(o)}).join("\r\n"),t.map(function(t,e){return t.map(function(t,e){return'"'+(""+t).replace(/"/g,'""').replace(/\n/g,"\r")+'"'}).join(o)}).join("\r\n")},toArray:function(t,e){for(var o,r=p.toString(t,e=null==e?"\t":e),l=new Uint8Array(2+2*r.length),n=0,a=r.length;n<a;++n)l[2*(o=n)+2]=r.charCodeAt(o),l[2*o+3]=r.charCodeAt(o)>>8;return l[0]=255,l[1]=254,l},toXlsx:function(t,e){var o,r,l;if(null==e&&(e={}),!s())throw new Error("XLSX module not found. Please include xlsx.js in your project.");if(o=XLSX.utils.book_new(),r=XLSX.utils.aoa_to_sheet(t),e.forceText)for(l in r)"!"!==l[0]&&null!=r[l]&&(r[l].t="s");return XLSX.utils.book_append_sheet(o,r,"Sheet1"),o},toBlob:function(t,e){var o,r,l,n,a,i,u,c=(d=m(e=null==e?{delimiter:void 0,format:"auto",forceText:!1}:e)).format,f=d.delimiter,d=d.forceText;if("xlsx"===c||"auto"===c&&s())try{return o=p.toXlsx(t,{forceText:d}),r=XLSX.write(o,{type:"array",bookType:"xlsx"}),new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}catch(t){console.warn("Failed to create XLSX. Falling back to CSV/TSV format.",t)}if("html"===c)return l=p.toHtml(t,e.html||{}),new Blob([l],{type:"text/html"});if("xls-html"!==c)return n=p.toArray(t,f),new Blob([n],{type:","===f?"text/csv":"text/tab-separated-values"});for(l=p.toHtml(t,e.html||{}),(n=new Uint8Array(2+2*l.length))[0]=255,n[1]=254,a=0,i=l.length;a<i;++a)n[2*(u=a)+2]=l.charCodeAt(u),n[2*u+3]=l.charCodeAt(u)>>8;return new Blob([n],{type:"application/vnd.ms-excel"})},toHref:function(t,e){t=p.toBlob(t,e=null==e?{delimiter:void 0,format:"auto",forceText:!1}:e);return URL.createObjectURL(t)},download:function(t,e,o){var r,l;return null==e&&(e="data"),r=(l=m(o=null==o?{delimiter:void 0,format:"auto",forceText:!1}:o)).format,l=l.delimiter,r="xlsx"===r||"auto"===r&&s()?".xlsx":"html"===r?".html":"xls-html"===r?".xls":","===l?".csv":".tsv",l=this.toHref(t,o),(t=document.createElement("a")).setAttribute("href",l),t.setAttribute("download",e+(new RegExp("\\"+r+"$","i").exec(e)?"":r)),t.style.opacity=0,t.style.position="absolute",document.body.appendChild(t),t.click(),document.body.removeChild(t)},toHtml:function(t,e){for(var o,r,l,n,a,i,u,c='<table class="'+(o={tableClass:(e=null==e?{}:e).tableClass||"csv4xls-table",cellStyle:e.cellStyle||!0,headerRow:e.headerRow||!1}).tableClass+'">',f=0,d=t.length;f<d;++f){for(l=t[r=f],n=o.headerRow&&0===r?"th":"td",c+="<tr>",a=0,i=l.length;a<i;++a)u=l[a],c+="<"+n+(o.cellStyle?" style=\"mso-number-format:'\\@';\"":"")+">"+(""+u).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")+"</"+n+">";c+="</tr>"}return c+="</table>"}},e=function(t,e){return p.toHref(t,e=null==e?{delimiter:void 0,format:"auto",forceText:!1}:e)},o=e,r=p,l={}.hasOwnProperty;for(t in r)l.call(r,t)&&(o[t]=r[t]);"undefined"!=typeof module&&null!==module?module.exports=e:"undefined"!=typeof window&&null!==window&&(window.csv4xls=e)}.call(this);
